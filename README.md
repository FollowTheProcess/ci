[![License](https://img.shields.io/github/license/FollowTheProcess/ci)](https://github.com/FollowTheProcess/ci)
[![GitHub](https://img.shields.io/github/v/release/FollowTheProcess/ci?logo=github&sort=semver)](https://github.com/FollowTheProcess/ci)

# CI

Consistent, high quality, and configurable CI for various languages and ecosystems üõ†Ô∏è

- [CI](#ci)
  - [Go](#go)
    - [Inputs](#inputs)
    - [Usage](#usage)
    - [Permissions](#permissions)

## Go

A great drop in CI pipeline for Go projects!

- Run tests with `go test` on linux, macos, and windows with the option to pass in additional flags as desired
- Race detector on by default
- Go version automatically detected from `go.mod`
- Uses [tparse] to output a nice test summary to `$GITHUB_STEP_SUMMARY` (with an option to disable)
- Optionally upload coverage reports to [CodeCov.io] (with tokenless upload)
- Linting with [golangci-lint] via the [golangci-lint-action], driven from your local `.golangci-lint.yml` config
- Check for typos with [typos-cli]
- Vulnerability analysis with [govulncheck]
- Automatically discover and run fuzz tests in a matrix with a configurable fuzz time

<!-- Docs below generated by action-docs -->

<!-- action-docs-all source=".github/workflows/Go.yml" project="FollowTheProcess/ci/.github/workflows/Go.yml" version="v1.0.0" -->
### Inputs

| name                    | description                                                                                                                                                                                                                                                                                                                           | type      | required | default  |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------- | -------- | -------- |
| `test-summary`          | <p>Use https://github.com/mfridman/tparse to summarise test output to GITHUB<em>STEP</em>SUMMARY</p>                                                                                                                                                                                                                                  | `boolean` | `false`  | `true`   |
| `test-flags`            | <p>Additional flags to pass to <code>go test</code>. <code>-race</code>, <code>-cover</code> and <code>-covermode</code> are all already set. If <code>test-summary</code> is true, then the <code>-json</code> flag will be automatically set as well. But here you may pass <code>-v</code> for example or any other test flag.</p> | `string`  | `false`  | `""`     |
| `fuzz`                  | <p>Automatically generate a matrix of fuzz tests and run them in parallel for a configurable <code>fuzz-time</code>. If there are no fuzz tests in the project, this is a no op so is a safe option to leave on.</p>                                                                                                                  | `boolean` | `false`  | `true`   |
| `fuzz-time`             | <p>Time (in Go <code>time.Duration</code> format) to run each fuzz test for</p>                                                                                                                                                                                                                                                       | `string`  | `false`  | `1m`     |
| `codecov`               | <p>Send coverage data to CodeCov.io. Requires that tokenless uploading has been configured and is enabled.</p>                                                                                                                                                                                                                        | `boolean` | `false`  | `true`   |
| `golangci-lint-version` | <p>The version of golangci-lint to use</p>                                                                                                                                                                                                                                                                                            | `string`  | `false`  | `latest` |
| `timeout-minutes`       | <p>Maximum number of minutes to let each step execute for, will be cancelled when timeout is met.</p>                                                                                                                                                                                                                                 | `number`  | `false`  | `15`     |
| `working-directory`     | <p>The working directory to be in for the entire workflow</p>                                                                                                                                                                                                                                                                         | `string`  | `false`  | `.`      |

### Usage

```yaml
jobs:
  job1:
    uses: FollowTheProcess/ci/.github/workflows/Go.yml@v0.1.0
    with:
      test-summary:
      # Use https://github.com/mfridman/tparse to summarise test output to GITHUB_STEP_SUMMARY
      #
      # Type: boolean
      # Required: false
      # Default: true

      test-flags:
      # Additional flags to pass to `go test`. `-race`, `-cover` and `-covermode` are all already set. If `test-summary` is true, then the `-json` flag will be automatically set as well. But here you may pass `-v` for example or any other test flag.
      #
      # Type: string
      # Required: false
      # Default: ""

      fuzz:
      # Automatically generate a matrix of fuzz tests and run them in parallel for a configurable `fuzz-time`. If there are no fuzz tests in the project, this is a no op so is a safe option to leave on.
      #
      # Type: boolean
      # Required: false
      # Default: true

      fuzz-time:
      # Time (in Go `time.Duration` format) to run each fuzz test for
      #
      # Type: string
      # Required: false
      # Default: 1m

      codecov:
      # Send coverage data to CodeCov.io. Requires that tokenless uploading has been configured and is enabled.
      #
      # Type: boolean
      # Required: false
      # Default: true

      golangci-lint-version:
      # The version of golangci-lint to use
      #
      # Type: string
      # Required: false
      # Default: latest

      timeout-minutes:
      # Maximum number of minutes to let each step execute for, will be cancelled when timeout is met.
      #
      # Type: number
      # Required: false
      # Default: 15

      working-directory:
      # The working directory to be in for the entire workflow
      #
      # Type: string
      # Required: false
      # Default: .
```
<!-- action-docs-all source=".github/workflows/Go.yml" project="FollowTheProcess/ci/.github/workflows/Go.yml" version="v1.0.0" -->

### Permissions

<!-- Detail the permissions that it needs here -->

This workflow needs the following permissions when invoked:

```yaml
contents: read # For checking out your code
```

[tparse]: https://github.com/mfridman/tparse
[CodeCov.io]: https://about.codecov.io/
[golangci-lint]: https://golangci-lint.run/
[golangci-lint-action]: https://github.com/golangci/golangci-lint-action
[govulncheck]: https://go.dev/blog/vuln
[typos-cli]: https://github.com/crate-ci/typos
